<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2024年江西省“振兴杯”职业技能大赛信息安全测试员(渗透测试员)赛项 Misc-wp</title>
    <link href="/2024/10/27/2024-JX-ZXB-stcsy-misc/"/>
    <url>/2024/10/27/2024-JX-ZXB-stcsy-misc/</url>
    
    <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="0x01-haveflag2"><a href="#0x01-haveflag2" class="headerlink" title="0x01 haveflag2"></a>0x01 haveflag2</h4><p><a href="https://www.imagehub.cc/image/image.CgVuTS"><img src="https://s1.imagehub.cc/images/2024/11/01/988064433a42b38977d033746ffdb988.webp" alt="image"></a></p><p>发现http流量中有压缩包，导出http</p><p><a href="https://www.imagehub.cc/image/image1.CgVaRt"><img src="https://s1.imagehub.cc/images/2024/11/01/a547a9ceb52f8bd0d4d8e05e06f92032.webp" alt="image1"></a></p><p>分析压缩包，无密码解压得到一张图片和一个word文档</p><p>先对文档分析，空白的，全选设置字体为红色得到一串字符</p><p><a href="https://www.imagehub.cc/image/image2.CgVQMv"><img src="https://s1.imagehub.cc/images/2024/11/01/da7097970a66f773198a38fba4a3063b.webp" alt="image2"></a></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">FGsdtu89$<br></code></pre></td></tr></table></figure><p>word文档分析没有其他东西再转向图片文件分析</p><p>分析到图片尾部发现图片中还有个压缩包，而压缩包的内容为另一张png图片</p><p><a href="https://www.imagehub.cc/image/image3.CgV9fL"><img src="https://s1.imagehub.cc/images/2024/11/01/40e9a7d8e71fb04aa4106da08431c692.webp" alt="image3"></a></p><p>将内容复制出来，或者使用工具对其进行分离</p><p><a href="https://www.imagehub.cc/image/image4.CgVTtB"><img src="https://s1.imagehub.cc/images/2024/11/01/2ec753829c402d70f6d3f6786dd06138.webp" alt="image4"></a></p><p>搜索png图片的文件尾部</p><p>从PK压缩包头部50 4B开始复制另存为一个新文件</p><p><a href="https://www.imagehub.cc/image/image5.CgVVLq"><img src="https://s1.imagehub.cc/images/2024/11/01/c8e247d9aca185e7a9310da0dcbfd86b.webp" alt="image5"></a></p><p><a href="https://www.imagehub.cc/image/image6.CgVh5U"><img src="https://s1.imagehub.cc/images/2024/11/01/05549944e7ca3a625032b28d5b3b4897.webp" alt="image6"></a></p><p>可以看到压缩包有加密</p><p><a href="https://www.imagehub.cc/image/image7.CgVo60"><img src="https://s1.imagehub.cc/images/2024/11/01/0cb673cd6ad35d5046cd77a69e2a4064.webp" alt="image7"></a></p><p>这时候可以用到word文档中的那串字符尝试进行解密</p><p>尝试解密发现就是压缩包的密码</p><p><a href="https://www.imagehub.cc/image/image8.CgVXJz"><img src="https://s1.imagehub.cc/images/2024/11/01/713b937ea2b0fffbc9d8012ffdab522d.webp" alt="image8"></a></p><p>得到一张二维码，使用CQR二维码解码工具进行扫描</p><p><a href="https://www.imagehub.cc/image/image9.CgVZmj"><img src="https://s1.imagehub.cc/images/2024/11/01/8f98b580f9252d2bcfdcaa485b7c6eb2.webp" alt="image9"></a></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;fjgnc59TJoomcewmzrr0vnsmi&#125;<br></code></pre></td></tr></table></figure><h4 id="0x02-文字文稿1"><a href="#0x02-文字文稿1" class="headerlink" title="0x02 文字文稿1"></a>0x02 文字文稿1</h4><p><a href="https://www.imagehub.cc/image/image10.CgVzgg"><img src="https://s1.imagehub.cc/images/2024/11/01/b6e21962999e3fdc6db9c21ffd235fc4.webp" alt="image10"></a></p><p>拿到题目附件</p><p><a href="https://www.imagehub.cc/image/image11.CgV2Ro"><img src="https://s1.imagehub.cc/images/2024/11/01/f2f72cbba7ec83307481cf7a0d75285b.webp" alt="image11"></a></p><p>发现有一句诗，全选一下设置字体为红色</p><p><a href="https://www.imagehub.cc/image/image12.CgV7VR"><img src="https://s1.imagehub.cc/images/2024/11/01/ca6936f20464dd4144f64c49b3ec6fd7.webp" alt="image12"></a></p><p>可以发现word文档底部还有一串摩斯电码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">..--- -.-. ....- ----- ....<br></code></pre></td></tr></table></figure><p><a href="https://www.imagehub.cc/image/image13.CgVqrb"><img src="https://s1.imagehub.cc/images/2024/11/01/d986e48f9bb70b5c8ed0a0a6ca81b5f1.webp" alt="image13"></a></p><p>使用工具解码后得到一串字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">2C40H<br></code></pre></td></tr></table></figure><p>这时候想到去分析文件的数据</p><p><a href="https://www.imagehub.cc/image/image14.CgV5tT"><img src="https://s1.imagehub.cc/images/2024/11/01/591c6a62c6b15648f1dae129b7da20f0.webp" alt="image14"></a></p><p>可以看到文件中有txt文本，还有一串base编码</p><p>，我们先对base编码进行解码操作，base64解码</p><p><a href="https://www.imagehub.cc/image/image15.CgVY6a"><img src="https://s1.imagehub.cc/images/2024/11/01/01e8b9b03e98db66ad80b1abdf8cb5ac.webp" alt="image15"></a></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;rlnujmbsf4d19ytoexi0wpgq7czh82v3&#125;<br></code></pre></td></tr></table></figure><p>这时候想继续去分析一下txt文件，使用工具对word文档进行分离</p><p><a href="https://www.imagehub.cc/image/image16.CgVAQ4"><img src="https://s1.imagehub.cc/images/2024/11/01/d22e2d38de69297bb9f5b5d7720be15e.webp" alt="image16"></a></p><p><a href="https://www.imagehub.cc/image/image17.CgVDAd"><img src="https://s1.imagehub.cc/images/2024/11/01/c7e4e0e0a0bd0c305513433a4a59d59d.webp" alt="image17"></a></p><p>解压查看txt文件内容</p><p><a href="https://www.imagehub.cc/image/image18.CghdKO"><img src="https://s1.imagehub.cc/images/2024/11/01/09565f483a0898d47223b1ecf61d71c9.webp" alt="image18"></a></p><p>文件大小为0</p><p>可能正是和文本文件的名字一样，用来误导ctfer的，所以说做题的时候还是需要仔细分析，如果真到山穷水尽的时候不妨回头看看</p><h4 id="0x03-aaa"><a href="#0x03-aaa" class="headerlink" title="0x03 aaa"></a>0x03 aaa</h4><p><a href="https://www.imagehub.cc/image/image19.CghfmA"><img src="https://s1.imagehub.cc/images/2024/11/01/0d3c85057a5bf7660a842fbbe6efbb67.webp" alt="image19"></a></p><p>拿到内存镜像，使用vol分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw imageinfo<br></code></pre></td></tr></table></figure><p><a href="https://www.imagehub.cc/image/image20.Cgh1gk"><img src="https://s1.imagehub.cc/images/2024/11/01/fb98af85b872617a7d238a5d3c3a2a04.webp" alt="image20"></a></p><p>使用filescan插件进行筛选</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 filescan | grep -E &quot;txt|zip|flag&quot;<br></code></pre></td></tr></table></figure><p><a href="https://www.imagehub.cc/image/image21.Cghbc6"><img src="https://s1.imagehub.cc/images/2024/11/01/98159cc137ae2340d854c6046ff8f70e.webp" alt="image21"></a></p><p>搭配grep筛选包含关键字的内容</p><p>可以看到得到一个名为fll4g的zip压缩包</p><p>我们导出一下压缩包文件进行分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 dumpfiles -Q 0x00000000144b5590 -D ./<br></code></pre></td></tr></table></figure><p><a href="https://www.imagehub.cc/image/image22.CghCV7"><img src="https://s1.imagehub.cc/images/2024/11/01/716e51eaaec15ecd53f74725cfaddcad.webp" alt="image22"></a></p><p><a href="https://www.imagehub.cc/image/image23.CghMrJ"><img src="https://s1.imagehub.cc/images/2024/11/01/4e4b870c78210ae8cabca38de0b9f1c4.webp" alt="image23"></a></p><p>文件加密，经过一番查找并未得到有关密码的内容，</p><p>现在只剩下俩个办法，对压缩包进行暴力破解   （X）</p><p>对内存镜像的用户密码进行破解</p><p><code>Passware Kit Forensic</code></p><p>使用到这个工具</p><p><a href="https://www.imagehub.cc/image/image24.Cghgxe"><img src="https://s1.imagehub.cc/images/2024/11/01/42836502840842134d565b9fa4bb2122.webp" alt="image24"></a></p><p>在主页选择内存分析</p><p><a href="https://www.imagehub.cc/image/image25.CghwQZ"><img src="https://s1.imagehub.cc/images/2024/11/01/97d757036f7aedf1b246d7b7eb18cd8b.webp" alt="image25"></a></p><p>选择好镜像后直接下一步，剩下的就是耐心等待</p><p><a href="https://www.imagehub.cc/image/image26.CgheAs"><img src="https://s1.imagehub.cc/images/2024/11/01/bf299598bc03f6459fd2d710450248c7.webp" alt="image26"></a></p><p>得到admin用户的密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">P@55w0rd!<br></code></pre></td></tr></table></figure><p>尝试使用这个密码对压缩包进行解压，发现是正确的密码</p><p><a href="https://www.imagehub.cc/image/image27.Cgh0nI"><img src="https://s1.imagehub.cc/images/2024/11/01/96973d4b3709083ff5451e5839b0ae97.webp" alt="image27"></a></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;64cf9601989168f7ced3aeea9064c411&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
