<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2024年江西省“振兴杯”职业技能大赛信息安全测试员(渗透测试员)赛项 Misc-wp</title>
    <link href="/2024/10/27/2024-JX-ZXB-stcsy-misc/"/>
    <url>/2024/10/27/2024-JX-ZXB-stcsy-misc/</url>
    
    <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="0x01-haveflag2"><a href="#0x01-haveflag2" class="headerlink" title="0x01 haveflag2"></a>0x01 haveflag2</h4><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273010490-2f72ad3b-0c29-4f8e-a4ad-8cf79459fc09.png" alt="img"></p><p>发现http流量中有压缩包，导出http</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273043357-b3a4f931-580f-4f01-b068-a1261df9e5c4.png" alt="img"></p><p>分析压缩包，无密码解压得到一张图片和一个word文档</p><p>先对文档分析，空白的，全选设置字体为红色得到一串字符</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273171015-8eb1ee23-92f4-4f73-85d0-d22a815954e1.png" alt="img"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">FGsdtu89$<br></code></pre></td></tr></table></figure><p>word文档分析没有其他东西再转向图片文件分析</p><p>分析到图片尾部发现图片中还有个压缩包，而压缩包的内容为另一张png图片</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273395747-e6eb6962-2e3a-48f0-9d3d-4c037cd97199.png" alt="img"></p><p>将内容复制出来，或者使用工具对其进行分离</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273610907-d72d9260-256f-49e0-bc3e-7aacfc7fbfac.png" alt="img"></p><p>搜索png图片的文件尾部</p><p>从PK压缩包头部50 4B开始复制另存为一个新文件</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273667319-bdb6c984-85a9-4604-b43b-e4551cf2c498.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273690194-e66266e4-1b73-4b7f-9bae-7174183e33e0.png" alt="img"></p><p>可以看到压缩包有加密</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273721380-2a77a8d5-d141-40c4-af2a-62ddae09b343.png" alt="img"></p><p>这时候可以用到word文档中的那串字符尝试进行解密</p><p>尝试解密发现就是压缩包的密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273778673-2a6d114e-374c-49d6-bf3d-d232ac08fbd2.png" alt="img"></p><p>得到一张二维码，使用CQR二维码解码工具进行扫描</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273837363-d767ddf4-8dd3-4f0a-94af-1bf7b2c761f6.png" alt="img"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;fjgnc59TJoomcewmzrr0vnsmi&#125;<br></code></pre></td></tr></table></figure><h4 id="0x02-文字文稿1"><a href="#0x02-文字文稿1" class="headerlink" title="0x02 文字文稿1"></a>0x02 文字文稿1</h4><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273958007-abf87d28-050a-42eb-b828-d56322f4fefa.png" alt="img">拿到题目附件</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730273981422-6683b019-4c5d-4444-826a-64fde6faa1ac.png" alt="img"></p><p>发现有一句诗，全选一下设置字体为红色</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274059897-1ea49928-1c1b-4ea2-a708-6e37ae6f359b.png" alt="img"></p><p>可以发现word文档底部还有一串摩斯电码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">..--- -.-. ....- ----- ....<br></code></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274148225-f9cc7c1c-968b-4a71-ba66-88e6bf2cf041.png" alt="img"></p><p>使用工具解码后得到一串字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">2C40H<br></code></pre></td></tr></table></figure><p>这时候想到去分析文件的数据</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274253617-937bc8bf-e5c1-4992-97e3-af0831db3d89.png" alt="img"></p><p>可以看到文件中有txt文本，还有一串base编码</p><p>，我们先对base编码进行解码操作，base64解码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274333070-1c37b241-0158-4f7f-8e0a-05b701e449f7.png" alt="img"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;rlnujmbsf4d19ytoexi0wpgq7czh82v3&#125;<br></code></pre></td></tr></table></figure><p>这时候想继续去分析一下txt文件，使用工具对word文档进行分离</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274617065-f5352d22-2c7e-4e27-9705-ec6340141d4a.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274636821-0629da19-7d8f-4df5-9a5a-e691ecbcd61b.png" alt="img"></p><p>解压查看txt文件内容</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730274666239-f78ffc3d-8552-4a0d-874c-65cf4bf81a3d.png" alt="img"></p><p>文件大小为0</p><p>可能正是和文本文件的名字一样，用来误导ctfer的，所以说做题的时候还是需要仔细分析，如果真到山穷水尽的时候不妨回头看看</p><h4 id="0x03-aaa"><a href="#0x03-aaa" class="headerlink" title="0x03 aaa"></a>0x03 aaa</h4><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730275201623-c96e2a1c-d0ed-4368-9d47-b07c1c911b68.png" alt="img"></p><p>拿到内存镜像，使用vol分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw imageinfo<br></code></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730275716788-b79be48e-5847-4a33-878d-e4a4c422f4fe.png" alt="img"></p><p>使用filescan插件进行筛选</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 filescan | grep -E &quot;txt|zip|flag&quot;<br></code></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730276224166-a1796fc1-47fd-4472-ac95-49a4a8388f3e.png" alt="img"></p><p>搭配grep筛选包含关键字的内容</p><p>可以看到得到一个名为fll4g的zip压缩包</p><p>我们导出一下压缩包文件进行分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 dumpfiles -Q 0x00000000144b5590 -D ./<br></code></pre></td></tr></table></figure><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730276479755-bfbda576-f1ad-4f8f-8d16-68422e4f39c5.png" alt="img"></p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730276885265-3b5084fa-6e1a-4ae2-9462-53d80987cdc0.png" alt="img"></p><p>文件加密，经过一番查找并未得到有关密码的内容，</p><p>现在只剩下俩个办法，对压缩包进行暴力破解   （X）</p><p>对内存镜像的用户密码进行破解</p><p><code>Passware Kit Forensic</code></p><p>使用到这个工具</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730277057875-af63f92b-4409-4d33-804e-56baf6aac77f.png" alt="img"></p><p>在主页选择内存分析</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730277075326-bbf5ee16-57b5-4ce9-a29f-d0bdf889381c.png" alt="img"></p><p>选择好镜像后直接下一步，剩下的就是耐心等待</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730278173632-519c6f09-effe-4cc0-97d5-5de5b91a5c47.png" alt="img"></p><p>得到admin用户的密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">P@55w0rd!<br></code></pre></td></tr></table></figure><p>尝试使用这个密码对压缩包进行解压，发现是正确的密码</p><p><img src="https://cdn.nlark.com/yuque/0/2024/png/22284972/1730278249022-166a2bd2-6c5f-48ed-8189-c5230c578a3b.png" alt="img"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;64cf9601989168f7ced3aeea9064c411&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
